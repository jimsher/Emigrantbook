<!DOCTYPE html>
<html lang="ka">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
 <title>EmigrantBook | Token Impact</title>
 <link rel="stylesheet" href="style.css">
 <link rel="stylesheet" href="shopping.css">
 <link rel="stylesheet" href="chatvirtva.css">
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
 <script src="https://js.stripe.com/v3/"></script>
 


 <style>
 .navbar {
 position: fixed !important; 
 top: 0 !important; 
 left: 0 !important; 
 width: 100% !important; 
 height: 56px !important;
 background: transparent !important; /* საერთოდ არანაირი ფერი */
 backdrop-filter: none !important; /* მოვაშორეთ დაბურვა */
 -webkit-backdrop-filter: none !important;
 border-bottom: none !important; /* მოვაშორეთ ხაზიც */
 box-shadow: none !important;
 display: flex !important; 
 align-items: center !important; 
 justify-content: space-between !important;
 padding: 0 15px !important; 
 z-index: 10000 !important;
}
 #main-feed {
 height: 100vh !important; /* მთელი ეკრანი */
 width: 100vw !important; 
 overflow-y: scroll !important;
 scroll-snap-type: y mandatory !important; 
 scrollbar-width: none !important; 
 padding-top: 0 !important; /* არანაირი დაშორება ზემოდან */
 margin-top: 0 !important;
 scroll-padding-top: 0 !important;
}
 .video-card {
 height: 100vh !important; 
 width: 100% !important; 
 scroll-snap-align: start !important; /* ყოველთვის ზედა კიდეზე გასწორდეს */
 scroll-snap-stop: always !important; 
 position: relative !important; 
 background: #000 !important;
}
@keyframes pulse-live {
    0% { border-color: #ff4d4d; box-shadow: 0 0 0 0 rgba(255, 77, 77, 0.4); }
    70% { border-color: #ff0000; box-shadow: 0 0 0 10px rgba(255, 77, 77, 0); }
    100% { border-color: #ff4d4d; box-shadow: 0 0 0 0 rgba(255, 77, 77, 0); }
}


  .msg-bubble {
    display: flex;
    flex-direction: column;
    max-width: 75%;
    margin-bottom: 8px;
    padding: 8px 12px;
    border-radius: 15px;
    word-wrap: break-word;
}






  /* ფოტოების ბადე - ზუსტად იმეორებს ვიდეოებისას */
#userPhotosGrid {
    display: grid;
    grid-template-columns: repeat(3, 1fr); /* 3 სვეტი */
    gap: 2px;
    margin-top: 20px;
}

/* თუ გინდა რომ ფოტოებიც Reels-ივით გრძელი იყოს */
#userPhotosGrid .grid-item {
    aspect-ratio: 9 / 16; /* ვერტიკალური ფორმატი */
    background: #111;
    overflow: hidden;
    border-radius: 5px;
    cursor: pointer;
}



  /* ვაძლევთ კომენტარებს უფრო მაღალ z-index-ს, რომ ფოტოს გადაეფაროს */
/* კომენტარების პანელი უნდა იყოს ყველაზე ზემოთ */
#commentsUI {
    z-index: 500000 !important; 
}

/* თუ იყენებ რაიმე ფონს (overlay) კომენტარებისთვის, იმასაც მოუმატე */
.comments-overlay {
    z-index: 499999 !important;
}


  #photoLikeIcon {
    transition: transform 0.2s ease-in-out, color 0.2s;
}






  .profile-nav-menu {
    display: flex;
    justify-content: space-around;
    align-items: center;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    margin-top: 15px;
    padding: 12px 0;
    background: rgba(0,0,0,0.2); /* ოდნავ მუქი ფონი გამოყოფისთვის */
}

.p-nav-btn {
    background: none;
    border: none;
    color: #555; /* არააქტიური აიქონები */
    font-size: 18px; /* ოდნავ პატარა ზომა 5 ღილაკისთვის */
    flex: 1;
    cursor: pointer;
    transition: 0.3s ease;
    position: relative;
}

.p-nav-btn.active {
    color: var(--gold) !important;
}

.p-nav-btn.active::after {
    content: '';
    position: absolute;
    bottom: -12px;
    left: 15%;
    width: 70%;
    height: 2px;
    background: var(--gold);
    box-shadow: 0 0 8px var(--gold);
}




  /* ვიდეო კუბიკის კონტეინერი */
.grid-item {
    position: relative !important;
}

/* ნახვების მთვლელი ვიდეოზე */
.video-views-label {
    position: absolute;
    bottom: 8px;
    left: 8px;
    color: white;
    font-size: 11px;
    font-weight: bold;
    display: flex;
    align-items: center;
    gap: 4px;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.8); /* რომ ნათელ ფონზეც გამოჩნდეს */
    z-index: 10;
    pointer-events: none;
}

.video-views-label i {
    font-size: 10px;
}












  /* კონტეინერი, სადაც ანიმაციები ხდება */
.live-activity-overlay {
    position: absolute;
    bottom: 110px;
    left: 15px;
    width: 250px; /* გავზარდეთ სიგანე გადიდებული ელემენტებისთვის */
    height: 220px; /* ცოტა სიმაღლე მოვუმატეთ */
    pointer-events: none;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    mask-image: linear-gradient(to top, black 60%, transparent 100%);
    -webkit-mask-image: linear-gradient(to top, black 60%, transparent 100%);
    overflow: hidden;
    z-index: 100;
}


/* კომენტარის ფორმის გასწორება */
.floating-comment {
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(5px);
    color: white;
    padding: 8px 14px;
    border-radius: 20px;
    font-size: 14px;
    margin-bottom: 8px;
    /* სიგანის კონტროლი */
    width: auto;
    max-width: 200px; 
    display: flex;
    align-items: center;
    gap: 8px;
    border: 1px solid rgba(212, 175, 55, 0.3);
    animation: smoothFlowUp 8s linear forwards;
    word-break: break-word; /* გრძელი სიტყვა რომ არ გადავიდეს */
}

/* ავატარი გულით - გადიდებული */
.floating-avatar-box {
    position: relative;
    display: flex;
    align-items: center;
    gap: 5px;
    animation: smoothFlowUp 6s linear forwards;
    margin-bottom: 15px; /* დაშორება კომენტარსა და ავატარს შორის */
}


.floating-avatar-box img {
    width: 48px !important;
    height: 48px !important;
    border-radius: 50%;
    border: 2px solid var(--gold);
    object-fit: cover;
}
  
.floating-avatar-box i {
    color: #ff4d4d;
    font-size: 18px; /* გულიც გაიზარდა 14-დან 18-მდე */
    filter: drop-shadow(0 0 5px #ff4d4d);
}

/* ახალი ანიმაცია: ჩნდება ადგილზე -> ყოვნდება -> მიდის */
@keyframes smoothFlowUp {
    0% { transform: translateY(0); opacity: 0; }
    5% { transform: translateY(0); opacity: 1; }  /* ადგილზე გაჩენა */
    20% { transform: translateY(0); opacity: 1; } /* მცირე დაყოვნება ადგილზე */
    100% { transform: translateY(-200px); opacity: 0; } /* სხვებთან ერთად სვლა */
}
 </style>
</head>




<div id="liveFloatingBtn" onclick="openActiveLivesModal()" style="display:none; position:fixed; right:20px; top:100px; z-index:9999; cursor:pointer; t
 ext-align:center;">
    <div style="width:60px; height:60px; border-radius:50%; border:3px solid #ff4d4d; padding:2px; background:#000; box-shadow: 0 0 15px rgba(255,77,77,0.5); animation: pulse-live 1.5s infinite;">
        <img id="lastLiveAva" src="" style="width:100%; height:100%; border-radius:50%; object-fit:cover;">
    </div>
    <div style="background:#ff4d4d; color:white; font-size:10px; font-weight:900; padding:2px 8px; border-radius:10px; margin-top:-10px; position:relative; border:2px solid #000;">LIVE</div>
</div>

<div id="activeLivesModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); backdrop-filter:blur(10px); z-index:100000; align-items:center; justify-content:center;">
    <div style="background:#1a1a1a; width:85%; max-width:400px; border-radius:20px; border:1px solid var(--gold); padding:20px;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <b style="color:var(--gold); letter-spacing:1px;">აქტიური ლაივები</b>
            <i class="fas fa-times" onclick="closeActiveLivesModal()" style="color:gray; cursor:pointer; font-size:20px;"></i>
        </div>
        <div id="modalLivesList" style="display:flex; flex-direction:column; gap:15px; max-height:400px; overflow-y:auto;">
            </div>
    </div>
</div>
<body>
 <audio id="msgSound" src="https://emigrantbook.com/messenger_notification.mp3" preload="auto"></audio>
 <audio id="typingSound" src="https://emigrantbook.com/messenger_typing.mp3" preload="auto"></audio>

 <div id="globalPush" class="global-push-notif">
 <img id="pushAva" src="" style="width:40px; height:40px; border-radius:50%; border:1px solid var(--gold);">
 <div>
 <b id="pushName" style="color:var(--gold); font-size:13px; display:block;"></b>
 <span id="pushTxt" style="font-size:12px; color:white;"></span>
 </div>
 </div>

 <div id="onboardingUI" class="auth-overlay" style="display: none; z-index: 60000; background: rgba(0,0,0,0.95);">
 <div class="auth-card" style="max-width: 450px; border: 1px solid var(--gold);">
 <div id="obSlide1" class="ob-step">
 <h1 class="glowing-token" style="font-size: 40px;" data-key="welcome">WELCOME</h1>
 <h2 style="color:var(--gold); margin-bottom:15px;">IMPACT-არქიტექტორი</h2>
 <p style="color:var(--text); font-size:14px; line-height:1.6;" data-key="ob_desc1">შენ მოხვდი სივრცეში, სადაც ყოველი იდეა შედეგად გარდაიქმნება. ჩვენი პლატფორმა ეფუძნება რეალურ გავლენას (Impact).</p>
 <button class="profile-btn btn-gold" style="width:100%; margin-top:20px;" onclick="nextObSlide(2)" data-key="next">შემდეგი</button>
 </div>
 <div id="obSlide2" class="ob-step" style="display:none;">
 <h2 style="color:var(--gold); margin-bottom:15px;">AKHO TOKEN</h2>
 <p style="color:var(--text); font-size:14px; line-height:1.6;" data-key="ob_desc2">ეს არ არის უბრალოდ ციფრული აქტივი. ტოკენი შენი შრომის და გავლენის საზომია. შექმენი ღირებული კონტენტი და დააგროვე მხარდაჭერა.</p>
 <button class="profile-btn btn-gold" style="width:100%; margin-top:20px;" onclick="nextObSlide(3)" data-key="got_it">გავიგე წესები</button>
 </div>
 <div id="obSlide3" class="ob-step" style="display:none;">
 <h2 style="color:var(--gold); margin-bottom:15px;" data-key="agreement">📜 ჩვენი შეთანხმება</h2>
 <div id="tokenSuccessAnim" style="display:none; margin-bottom: 15px;">
 <div class="glowing-token" style="font-size: 50px;">💎</div>
 <p style="color:var(--gold); font-weight:bold;">IMPACT ACTIVATED</p>
 </div>
 <ul id="rulesList" style="text-align: left; color: var(--soft-text); font-size: 13px; list-style: none; padding: 0;">
 <li style="margin-bottom:8px;"><i class="fas fa-check" style="color:var(--gold);"></i> <span data-key="rule1">იყავი გამჭვირვალე და რეალური</span></li>
 <li style="margin-bottom:8px;"><i class="fas fa-check" style="color:var(--gold);"></i> <span data-key="rule2">პლატფორმაზე ქმედება ფასდება</span></li>
 <li style="margin-bottom:8px;"><i class="fas fa-check" style="color:var(--gold);"></i> <span data-key="rule3">ყოველი IMPACT აისახება ბალანსზე</span></li>
 </ul>
 <button class="profile-btn btn-gold" id="finishBtn" style="width:100%; margin-top:20px;" onclick="runSuccessAndFinish()" data-key="ready">მზად ვარ შედეგისთვის!</button>
 </div>
 </div>
 </div>

 <div id="authUI" class="auth-overlay">
 <img src="https://emigrantbook.com/1000084015-removebg-preview.png" class="auth-logo-img" alt="Tk Logo">
 <h1 class="glowing-token">TOKEN</h1>
 <div id="loginBox" class="auth-card">
 <input type="email" id="uEmail" class="auth-input" placeholder="Email / ელფოსტა">
 <input type="password" id="uPass" class="auth-input" placeholder="Password / პაროლი">
 <button style="width:100%; padding:14px; background:var(--gold); border:none; border-radius:8px; font-weight:bold; cursor:pointer;" onclick="handleAuth('login')" data-key="login">შესვლა</button>
 <p onclick="toggleAuthBox('reg')" style="color:var(--gold); text-align:center; margin-top:20px; cursor:pointer; font-size:14px;" data-key="create_account">ანგარიშის შექმნა</p>
 </div>
 <div id="regBox" class="auth-card" style="display:none;">
 <input type="text" id="rFirstName" class="auth-input" placeholder="First Name / სახელი">
 <input type="text" id="rLastName" class="auth-input" placeholder="Last Name / გვარი">
 <input type="email" id="rEmail" class="auth-input" placeholder="Email / ელფოსტა">
 <input type="password" id="rPass" class="auth-input" placeholder="Password / პაროლი">
 <button style="width:100%; padding:14px; background:var(--gold); border:none; border-radius:8px; font-weight:bold; cursor:pointer;" onclick="handleAuth('reg')" data-key="register">რეგისტრაცია</button>
 <p onclick="toggleAuthBox('login')" style="color:var(--gold); text-align:center; margin-top:20px; cursor:pointer;" data-key="have_account">უკვე გაქვთ ანგარიში?</p>
 </div>
 </div>

 <nav class="navbar">
 <div style="display: flex; align-items: center;">
 <a href="/" style="display: flex; align-items: center; text-decoration: none;">
 <img src="https://emigrantbook.com/1000084015-removebg-preview.png" style="height: 44px; width: auto;" alt="Tk">
 </a>
 </div>
 <div style="display: flex; align-items: center; gap: 15px;">
 <div style="position: relative;">
 <i class="fas fa-user-plus" style="color: var(--gold); font-size: 20px; cursor: pointer;" onclick="openRequestsUI()"></i>
 <span id="reqCount" class="req-badge">0</span>
 </div>
 
 <div onclick="openCommunityWall()" style="background: var(--gold); color: #000; padding: 5px 12px; border-radius: 8px; font-weight: 900; font-size: 12px; cursor: pointer; text-transform: uppercase; margin-right: 5px;">
 პოსტი
</div>

  <div onclick="openShopSection()" style="cursor:pointer; background: rgba(212, 175, 55, 0.1); border: 1px solid #d4af37; width: 34px; height: 34px; display: inline-flex; align-items: center; justify-content: center; border-radius: 8px; margin: 0 5px; transition: 0.2s;">
 <i class="fas fa-shopping-bag" style="color: #d4af37; font-size: 16px;"></i>
 </div>
 
 <div style="background:rgba(0,0,0,0.3); border:1px solid var(--gold); padding:5px 14px; border-radius:50px; cursor:pointer;" onclick="openWalletUI()">
 <span id="userAkho" style="color:var(--gold); font-weight:bold;">0.00</span>
 <small style="color:var(--gold); font-size:10px; font-weight:900;">AKHO</small>
 </div>
 </div>
 </nav>

 <div id="walletUI">
 <div class="wallet-card">
 <div id="walletMain">
 <h2 style="color:var(--gold); font-weight:900;">AKHO WALLET</h2>
 <p style="font-size:14px; color:var(--soft-text); margin-top:10px;" data-key="wallet_desc">შეავსეთ ბალანსი Stripe გადახდით</p>
 <p onclick="openInfoUI()" style="font-size:11px; color:var(--gold); cursor:pointer; margin-top:5px; text-decoration:underline;" data-key="how_it_works">როგორ მუშაობს AKHO?</p>
 <button onclick="openLeaderboard()" style="width:100%; background:rgba(212,175,55,0.1); border:1px solid var(--gold); color:var(--gold); padding:10px; border-radius:8px; margin-top:15px; cursor:pointer; font-weight:bold;">
 <i class="fas fa-medal"></i> ნახე რეიტინგი
 </button>
 <div class="package-grid">
 <div class="pkg-btn" onclick="initStripePayment('https://buy.stripe.com/test_28EdR90bE4TWbyCbPBcbC01')">
 <span class="pkg-price">€1.00</span>
 <span class="pkg-label">10 AKHO</span>
 </div>
 <div class="pkg-btn" onclick="initStripePayment('https://buy.stripe.com/test_14AcN56A25Y0fOS6vhcbC02')">
 <span class="pkg-price">€5.00</span>
 <span class="pkg-label">55 AKHO</span>
 </div>
 <div class="pkg-btn" onclick="initStripePayment('https://buy.stripe.com/test_dRm5kDaQi1HK326bPBcbC03')">
 <span class="pkg-price">€10.00</span>
 <span class="pkg-label">120 AKHO</span>
 </div>
 <div class="pkg-btn" onclick="initStripePayment('https://buy.stripe.com/test_5kQ3cve2u1HK5ae3j5cbC04')">
 <span class="pkg-price">€50.00</span>
 <span class="pkg-label">700 AKHO</span>
 </div>
 </div>

 <div class="cashout-box">
 <b style="color:var(--gold); font-size: 13px;" data-key="cash_out">თანხის გატანა</b>
 <p style="font-size: 11px; color: var(--soft-text); margin-top: 5px;" data-key="min_withdraw">მინიმალური გატანა: 50.00 € (500 AKHO)</p>
 <div id="cashoutForm" style="display:none; margin-top: 10px;">
 <input type="text" id="ibanInput" class="auth-input" placeholder="IBAN / PayPal" style="margin-bottom:5px; padding:10px;">
 <button class="withdraw-btn" onclick="submitWithdraw()" data-key="withdraw_req">გატანის მოთხოვნა</button>
 </div>
 <div id="cashoutStatus" style="color:var(--red); font-size: 11px; margin-top: 10px; font-weight: bold;"></div>
 </div>

 <div class="activity-log">
 <b style="color:var(--gold); font-size:14px;">აქტივობის ისტორია</b>
 <div id="logContent" style="margin-top:10px;"></div>
 </div>

 <button style="margin-top:25px; background:none; border:none; color:gray; cursor:pointer;" onclick="document.getElementById('walletUI').style.display='none'" data-key="close">დახურვა</button>
 </div>
 <div id="paymentPending" style="display:none; animation: fadeIn 0.5s;">
 <i class="fas fa-spinner fa-spin" style="font-size: 40px; color: var(--gold);"></i>
 <h2 style="color:var(--gold); margin-top:15px;" data-key="thanks">მადლობა!</h2>
 <p style="color:white; margin:15px 0;" data-key="payment_msg">გადახდა მიღებულია. AKHO თქვენს ბალანსზე აისახება 5-10 წუთში გადამოწმების შემდეგ.</p>
 <button class="profile-btn btn-gold" onclick="location.reload()" data-key="check_balance">ბალანსის გადამოწმება</button>
 </div>
 </div>
 </div>

 <div id="adminUI">
 <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
 <h2 style="color:var(--gold); font-weight:900;">ADMIN PANEL</h2>
 <span onclick="document.getElementById('adminUI').style.display='none'" style="cursor:pointer; font-size:24px; color:gray;">✕</span>
 </div>
 
 <div class="admin-tool-box">
 <b style="color:var(--gold);">მომხმარებლების მართვა</b>
 <input type="text" id="admSearch" class="auth-input" placeholder="სახელით ძებნა..." oninput="adminSearchUsers(this.value)" style="margin-top:10px;">
 <div id="admUserList" style="max-height: 200px; overflow-y: auto; background: #111; border-radius: 8px;"></div>
 </div>

 <div id="admUserActions" style="display:none;" class="admin-tool-box">
 <h4 id="admTargetName" style="color:white; margin-bottom:10px;"></h4>
 <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
 <button class="withdraw-btn" style="background:var(--gold); color:black;" onclick="adminAction('addAkho')">AKHO დარიცხვა</button>
 <button class="withdraw-btn" style="background:var(--red); color:white;" onclick="adminAction('resetAkho')">AKHO განულება</button>
 <button class="withdraw-btn" onclick="adminAction('warning')">გაფრთხილება</button>
 <button class="withdraw-btn" style="background:var(--red);" onclick="adminAction('ban')">დაბლოკვა</button>
 <button class="withdraw-btn" style="background:var(--green); color:black;" onclick="adminAction('unban')">ბლოკის მოხსნა</button>
 <button class="withdraw-btn" style="background:gray;" onclick="adminAction('delete')">წაშლა</button>
 </div>
 </div>

 <h3 style="color:var(--gold); margin: 15px 0 10px 0;">გატანის მოთხოვნები</h3>
 <div id="adminReqList" style="flex:1; overflow-y:auto;"></div>



 <button onclick="toggleStoreManager()" style="background:var(--gold); color:black; border:none; padding:10px; border-radius:8px; font-weight:bold; margin:5px; cursor:pointer;">
    🛍️ მაღაზიის მართვა
</button>

<div id="storeManagerSection" style="display:none; background:rgba(255,255,255,0.05); padding:20px; border-radius:15px; margin-top:15px; border:1px solid rgba(212,175,55,0.3);">
    <h3 style="color:var(--gold); margin-bottom:15px; font-size:16px;">📦 ახალი ნივთის დამატება</h3>
    
    <div style="display:grid; gap:10px;">
        <input type="text" id="newProdName" class="auth-input" placeholder="ნივთის სახელი">
        <input type="number" id="newProdPrice" class="auth-input" placeholder="ფასი (₾)">
        <input type="text" id="newProdStripeLink" class="auth-input" placeholder="Stripe ლინკი (ყულაბა)">
        
        <textarea id="newProdDesc" class="auth-input" placeholder="ნივთის დეტალური აღწერა..." style="height:80px;"></textarea>
        
        <div style="display:flex; gap:10px; align-items:center;">
            <select id="newProdCat" class="auth-input" style="flex:1;">
                <option value="ნივთები">ნივთები</option>
                <option value="ციფრული">ციფრული</option>
            </select>
            <input type="file" id="newProdFile" accept="image/*" style="flex:1; color:white; font-size:12px;">
        </div>
        
        <button onclick="saveProductToFirebase()" id="uploadBtn" style="background:#00ff00; color:black; border:none; padding:12px; border-radius:8px; font-weight:bold; cursor:pointer;">
            გამოქვეყნება 🚀
        </button>
    </div>

    <hr style="border:0; border-top:1px solid #333; margin:20px 0;">
    <h3 style="color:var(--gold); font-size:14px; margin-bottom:10px;">🗑️ არსებული ნივთები:</h3>
    <div id="adminProductList" style="display:grid; gap:10px;"></div>
</div>
  
 <div id="adminOrdersSection" style="margin-top:20px; border-top:1px solid #333; padding-top:20px;">
 <h3 style="color:var(--gold); font-size:16px; margin-bottom:15px;">📦 შემოსული შეკვეთები</h3>
 <div id="ordersList" style="display:flex; flex-direction:column; gap:10px;">
 <p style="color:gray; font-size:12px;">შეკვეთები არ არის...</p>
 </div>
</div>


  
 </div>
 <div id="infoUI">
 <div style="display:flex; justify-content:space-between; align-items:center;">
 <h2 style="color:var(--gold); font-weight:900;" data-key="rules_title">წესები და განმარტება</h2>
 <span onclick="document.getElementById('infoUI').style.display='none'" style="cursor:pointer; font-size:24px;">✕</span>
 </div>
 <div class="info-content">
 <div class="info-section">
 <div class="info-title"><i class="fas fa-coins"></i> <span data-key="what_is_akho">რა არის AKHO?</span></div>
 <p data-key="akho_desc">AKHO არის პლატფორმის შიდა აქტივი. მისი საშუალებით თქვენ შეგიძლიათ გამოხატოთ მხარდაჭერა და დააჯილდოოთ საინტერესო კონტენტი. 1 ევრო = 10 AKHO.</p>
 </div>
 <div class="info-section">
 <div class="info-title"><i class="fas fa-money-bill-wave"></i> <span data-key="make_money">როგორ ვიშოვოთ ფული?</span></div>
 <p data-key="make_money_desc">ატვირთეთ TOKEN (ვიდეო). როცა ვინმე თქვენს ვიდეოს "დაალაიქებს", თქვენს ბალანსზე ავტომატურად დაირიცხება <b>2.00 AKHO</b>.</p>
 </div>
 <div class="info-section">
 <div class="info-title"><i class="fas fa-shopping-cart"></i> <span data-key="top_up">ბალანსის შევსება</span></div>
 <p data-key="top_up_desc">გადახდა ხდება Stripe-ით. ტრანზაქციის დასრულების შემდეგ, AKHO აისახება 5-10 წუთში გადამოწმების შემდეგ.</p>
 </div>
 <div class="info-section">
 <div class="info-title"><i class="fas fa-gavel"></i> <span data-key="fees">ტარიფები და წესები</span></div>
 <p data-key="fees_list">• ლაიქი: -0.1 AKHO<br>• კომენტარი: -0.5 AKHO<br>• გამოწერა: -1.00 AKHO<br>• შეტყობინება: -0.2 AKHO</p>
 <small style="color:gray;" data-key="fees_footer">ყოველი ქმედება ღირებულია, რადგან ის პირდაპირ აჯილდოებს ავტორს.</small>
 </div>
 </div>
 </div>

 <div id="commentsUI">
 <div style="padding:18px; display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid rgba(212, 175, 55, 0.2);">
 <b style="color:var(--gold); font-size:16px; letter-spacing:1px;" data-key="comments">კომენტარები</b>
 <span onclick="document.getElementById('commentsUI').style.display='none'" style="cursor:pointer; color:gray; font-size:22px;">✕</span>
 </div>
 <div id="commList" style="flex:1; overflow-y:auto; padding:10px 0;"></div>
 <div style="padding:15px; background:rgba(25, 25, 25, 0.9); display:flex; gap:12px; border-top:1px solid rgba(212, 175, 55, 0.2); align-items:center;">
 <input type="text" id="commInp" class="chat-input" placeholder="..." style="margin-bottom:0; background:#000; border:1px solid #444;">
 <button class="chat-send-btn" onclick="postComment()" style="width:45px; height:45px;"><i class="fas fa-paper-plane"></i></button>
 </div>
 </div>

 <div id="requestsUI">
 <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
 <h2 style="color:var(--gold); font-weight:900;" data-key="notifications">შეტყობინებები</h2>
 <span onclick="document.getElementById('requestsUI').style.display='none'" style="cursor:pointer; font-size:24px;">✕</span>
 </div>
 <div id="reqList"></div>
 </div>

 <div id="discoveryUI">
 <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
 <h2 style="color:var(--gold); font-weight:900;" data-key="discover">აღმოაჩინე</h2>
 <span onclick="closeDiscovery()" style="cursor:pointer; font-size:20px; color:gray;">✕</span>
 </div>
 <input type="text" class="discover-search" placeholder="..." oninput="searchUsers(this.value)" id="searchPlaceholder">
 <div id="discoverGrid" class="discover-grid"></div>
 </div>

 <div id="visitorsUI">
 <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:25px;">
 <h2 style="color:var(--gold); font-weight:900; font-size: 20px;" data-key="profile_views">პროფილის ნახვები</h2>
 <span onclick="document.getElementById('visitorsUI').style.display='none'" style="cursor:pointer; font-size:26px; color:gray;">✕</span>
 </div>
 <div id="visitorsList" style="flex:1; overflow-y:auto;"></div>
 </div>

 <div id="editProfileUI">
 <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
 <h2 style="color:var(--gold); font-weight:900;" data-key="edit">რედაქტირება</h2>
 <span onclick="document.getElementById('editProfileUI').style.display='none'" style="cursor:pointer; font-size:26px; color:gray;">✕</span>
 </div>
 <label class="edit-label" data-key="full_name">სრული სახელი</label>
 <input type="text" id="editName" class="auth-input">
 <label class="edit-label" data-key="location">საცხოვრებელი ადგილი</label>
 <input type="text" id="editCity" class="auth-input" placeholder="...">
 <label class="edit-label" data-key="age">ასაკი</label>
 <input type="number" id="editAge" class="auth-input">
 <label class="edit-label" data-key="relation">ურთიერთობა</label>
 <select id="editRelation" class="auth-input" style="background:#2a2a2a; color:white; border:1px solid #444;">
 <option value="Single" data-key="single">დაუოჯახებელი</option>
 <option value="Married" data-key="married">დაოჯახებული</option>
 <option value="In Relationship" data-key="in_rel">ურთიერთობაში</option>
 </select>
 <label class="edit-label" data-key="phone">ტელეფონის ნომერი</label>
 <input type="tel" id="editPhone" class="auth-input">
 <button class="profile-btn btn-gold" style="width:100%; margin-top:30px; padding:15px;" onclick="saveProfileChanges()" data-key="save">ცვლილებების შენახვა</button>
 </div>

 <div id="userDetailedInfoUI">
 <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
 <h2 style="color:var(--gold); font-weight:900;" data-key="info">ინფორმაცია</h2>
 <span onclick="document.getElementById('userDetailedInfoUI').style.display='none'" style="cursor:pointer; font-size:26px; color:gray;">✕</span>
 </div>
 <div id="infoContent"></div>
 </div>

 <div id="settingsUI">
 <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:30px;">
 <h2 style="color:var(--gold); font-weight:900;" data-key="profile_manage">პროფილის მართვა</h2>
 <span onclick="document.getElementById('settingsUI').style.display='none'" style="cursor:pointer; font-size:26px; color:gray;">✕</span>
 </div>
 
 <div class="settings-option">
 <div>
 <b style="display:block;" data-key="public">საჯარო (Public)</b>
 <small style="color:gray;" data-key="public_desc">ნებისმიერ მომხმარებელს შეუძლია ნახოს თქვენი პროფილი</small>
 </div>
 <input type="radio" name="pPrivacy" value="public" id="privPublic" onchange="updatePrivacy('public')">
 </div>

 <div class="settings-option">
 <div>
 <b style="display:block;" data-key="friends">მეგობრებისთვის (Friends)</b>
 <small style="color:gray;" data-key="friends_desc">თქვენს პროფილს ნახავენ მხოლოდ ისინი, ვინც გამოწერილი გყავთ</small>
 </div>
 <input type="radio" name="pPrivacy" value="friends" id="privFriends" onchange="updatePrivacy('friends')">
 </div>

 <div class="settings-option">
 <div>
 <b style="display:block;" data-key="private">პრივატული (Private)</b>
 <small style="color:gray;" data-key="private_desc">თქვენს პროფილს ნახავთ მხოლოდ თქვენ</small>
 </div>
 <input type="radio" name="pPrivacy" value="private" id="privPrivate" onchange="updatePrivacy('private')">
 </div>

 <button class="profile-btn btn-gold" style="width:100%; margin-top:20px;" onclick="document.getElementById('settingsUI').style.display='none'" data-key="finish">დასრულება</button>
 </div>

 <div id="profileUI">
 <div class="profile-nav">
 <i class="fas fa-home" style="color: var(--soft-text); font-size: 22px; cursor: pointer;" onclick="document.getElementById('profileUI').style.display='none'; refreshHomeFeed();"></i>

  <a href="#" class="menu-item" onclick="openLeaderboard(); toggleSideMenu(false);">
    <i class="fas fa-medal" style="color:var(--gold);"></i> 
</a>
 
 <div style="display: flex; align-items: center; gap: 15px;">
 <i id="feetStats" class="fas fa-shoe-prints" style="color: var(--gold); font-size: 18px; cursor: pointer; display:none;" onclick="showProfileVisitors()"></i>
 
 <div class="menu-trigger" onclick="toggleSideMenu(true)">
 <span></span><span></span><span></span><span></span>
 </div>
 </div>
 </div>
 
 
<div class="profile-header">
    <div class="profile-ava-wrapper">
        <img id="profAva" src="" class="profile-ava-main">
        <div id="profStatusDot" class="status-dot">
            <span id="profLastSeenText" class="last-seen-tag"></span>
        </div>
    </div>
    
    <h2 id="profName" style="color:white; margin-top:10px;">Name</h2>
    
    <div class="profile-stats-row">
        <div class="stat-box">
            <span id="statVidsCount" class="stat-num">0</span>
            <span class="stat-label" data-key="videos">ვიდეო</span>
        </div>
        <div class="stat-box" id="followersStatBtn">
            <span id="statFollowersCount" class="stat-num">0</span>
            <span class="stat-label" data-key="followers">გამომწერი</span>
        </div>
        <div class="stat-box" id="followingStatBtn">
            <span id="statFollowingCount" class="stat-num">0</span>
            <span class="stat-label" data-key="following">გამოწერა</span>
        </div>
    </div>




 <div id="profControls" style="margin-top:15px; display: flex; align-items: center; justify-content: center; gap: 10px;">
    <div id="galleryUploadBtnContainer" style="display: none;">
        <div onclick="document.getElementById('gallery_photoFileInput').click()" 
             style="cursor:pointer; background: rgba(212, 175, 55, 0.1); border: 1px solid #d4af37; width: 40px; height: 40px; display: inline-flex; align-items: center; justify-content: center; border-radius: 10px; transition: 0.3s;">
            <i class="fas fa-camera" style="color: #d4af37; font-size: 18px;"></i>
        </div>
        <input type="file" id="gallery_photoFileInput" accept="image/*" hidden onchange="gallery_handleFileUpload(this)">
    </div>
</div>

<div id="profTabs" class="profile-nav-menu">
    <button class="p-nav-btn active" id="infoBtn" onclick="switchTab('info', this)">
        <i class="fas fa-th"></i>
    </button>
    
    <button class="p-nav-btn" id="photosBtn" onclick="openPhotosSection(); switchTab('photos', this)">
        <i class="fas fa-image"></i>
    </button>
    
    <button class="p-nav-btn" id="reelsBtn" onclick="switchTab('reels', this)">
        <i class="fas fa-play-circle"></i>
    </button>

    <button class="p-nav-btn" id="savedTabBtn" onclick="switchTab('saved', this)">
        <i class="fas fa-bookmark"></i>
    </button>

    <button class="p-nav-btn" id="taggedBtn" onclick="switchTab('tagged', this)">
        <i class="fas fa-user-tag"></i>
    </button>
</div>

<div id="profGrid" class="video-grid"></div>

<div id="userPhotosGrid" style="display: none; grid-template-columns: repeat(3, 1fr); gap: 5px; padding: 10px;">
</div>

<div id="noPhotosMsg" style="display:none; text-align:center; color:gray; padding:20px; font-size:13px;">
    ფოტოები ჯერ არ არის...
</div>
</div>
 </div>


 <div id="sideMenuOverlay" class="side-menu-overlay" onclick="toggleSideMenu(false)"></div>
 <div id="sideMenu" class="side-menu">
 <div style="display:flex; justify-content:flex-end; margin-bottom:20px;">
 <i class="fas fa-times" style="font-size:24px; color:var(--gold); cursor:pointer;" onclick="toggleSideMenu(false)"></i>
 </div>

 <a href="#" class="menu-item" onclick="toggleLanguage()">
 <i class="fas fa-globe"></i> 
 <span id="langSwitchBtn">Language: EN / ენა: ქარ</span>
 </a>

 <a href="#" class="menu-item" onclick="startLiveFunc()">
 <div class="live-btn-custom">
 <div class="live-status-dot"></div>
 <span data-key="live">ლაივი</span>
 </div>
 </a>
 <a href="#" class="menu-item">
 <i class="fas fa-euro-sign"></i> 
 <span><span data-key="real_balance">რეალური ბალანსი</span>: <b id="realCash">0.00</b> €</span>
 </a>

 <a href="#" id="adminMenuBtn" class="menu-item" style="display:none;" onclick="openAdminUI()">
 <i class="fas fa-user-shield" style="color:var(--red);"></i> ადმინ პანელი
 </a>

 <a href="#" class="menu-item" onclick="openEditor()"><i class="fas fa-edit"></i> <span data-key="editor">რედაქტორი</span></a>
 <a href="#" class="menu-item" onclick="openSettings()"><i class="fas fa-cog"></i> <span data-key="profile_manage">პროფილის მართვა</span></a>
 <a href="#" class="menu-item" onclick="openWalletUI(); toggleSideMenu(false);"><i class="fas fa-wallet"></i> <span data-key="balance">ბალანსი</span></a>
 <a href="#" class="menu-item" onclick="openInfoUI(); toggleSideMenu(false);"><i class="fas fa-info-circle"></i> <span data-key="info">ინფორმაცია</span></a>
 <div style="flex:1;"></div>
 <a href="#" class="menu-item" onclick="logoutUser()" style="border-top: 1px solid rgba(255,255,255,0.05); color: #ff4d4d;">
 <i class="fas fa-sign-out-alt" style="color: #ff4d4d;"></i> <span data-key="logout">გასვლა</span>
 </a>
 </div>

 <div id="messengerUI" style="display: none;">
 <div style="padding:15px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; align-items:center;">
 <h2 style="color:var(--gold); font-weight:900;" data-key="chats">ჩატები</h2>
 <span onclick="document.getElementById('messengerUI').style.display='none'; refreshHomeFeed();" style="cursor:pointer; font-size:24px; color:gray;">✕</span>
 </div>
 <div id="chatList" style="flex:1; overflow-y:auto;"></div>
</div>






 
<div id="individualChat" style="display: none;">
    <div class="chat-header">
        <div style="display:flex; align-items:center; gap:12px;">
            <i class="fas fa-arrow-left" onclick="closeChat()" style="cursor:pointer;"></i>
            <img id="chatTargetAva" src="" style="width:40px; height:40px; border-radius:50%; border:1px solid var(--gold);">
            
            <div style="display: flex; flex-direction: column;">
                <b id="chatTargetName" style="color:white; font-size:15px; line-height: 1.2;">Name</b>
                <span id="chatTargetStatus" style="font-size: 11px; color: #888;">...</span>
            </div>
        </div>

        <div style="display:flex; gap:18px; align-items:center;">
            <i class="fas fa-video" onclick="requestVideoCall()" style="cursor:pointer; color:var(--gold); font-size:18px;"></i>
            <i class="fas fa-times" onclick="closeChat()" style="cursor:pointer; font-size:20px; color:var(--soft-text);"></i>
        </div>
    </div>





 
 <div id="chatMessages" class="chat-messages"></div>
 
 <div id="typingIndicator" class="typing-indicator" style="display:none; margin-left: 15px; margin-bottom: 5px;">
 <div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>
 </div>

 <div class="chat-input-area" style="padding: 10px; display:flex; align-items:center; gap:10px; background: rgba(0,0,0,0.5);">
 <i class="fas fa-plus-circle" style="color:var(--gold); font-size:20px; cursor:pointer;"></i>
 <input type="text" id="messageInp" class="chat-input" placeholder="შეტყობინება..." oninput="handleTyping()" style="margin-bottom:0; border-radius: 20px;">
 
 <div id="voiceBtn" onclick="toggleVoiceRecord()" style="cursor:pointer; width:35px; height:35px; display:flex; align-items:center; justify-content:center; color:var(--gold);">
 <i class="fas fa-microphone" id="micIcon"></i>
 </div>
 
 <button class="chat-send-btn" onclick="sendMessage()" style="width:35px; height:35px; background:var(--gold); border-radius:50%; color:black; border:none;">
 <i class="fas fa-paper-plane" style="font-size:14px;"></i>
 </button>
 </div>
</div>

 <div id="fullVideoOverlay">
 <span class="close-full-video" onclick="closeFullVideo()">✕</span>
 <video id="fullVideoTag" controls autoplay loop style="width:100%; height:100%; object-fit:contain;"></video>
 </div>

 <div id="uploadModal">
 <div style="background: var(--card); padding: 25px; border-radius: 15px; width: 100%; max-width: 400px; border: 1px solid var(--gold);">
 <h3 style="color:var(--gold); margin-bottom:15px;" data-key="upload_token">TOKEN-ზე ატვირთვა</h3>
 <input type="file" id="videoInput" accept="video/*" style="margin-bottom:15px; color:white; width:100%;">
 <textarea id="videoDesc" placeholder="..." style="width:100%; padding:12px; background:#121212; border:1px solid #333; color:white; margin-bottom:15px; border-radius:8px; height:80px; resize:none;"></textarea>
 <button id="upBtn" onclick="startTokenUpload()" style="width:100%; padding:12px; background:var(--gold); border:none; border-radius:8px; font-weight:bold; color:black;" data-key="upload">ატვირთვა</button>
 <button onclick="document.getElementById('uploadModal').style.display='none'" style="width:100%; background:none; border:none; color:gray; margin-top:10px; cursor:pointer;" data-key="cancel">გაუქმება</button>
 </div>
 </div>




 <div id="main-feed"></div>

 <div id="socialListsUI" style="display:none;">
 <div class="social-list-header">
 <i class="fas fa-chevron-left" style="color:var(--gold); font-size:20px; cursor:pointer;" onclick="document.getElementById('socialListsUI').style.display='none'"></i>
 <b id="socialListTitle" style="color:white; font-size:18px;">სია</b>
 <div style="width:20px;"></div>
 </div>
 <div class="social-search-box">
 <input type="text" class="social-search-input" id="socialQuickSearch" placeholder="მოძებნე სახელით..." oninput="filterSocialList(this.value)">
 </div>
 <div id="socialContentArea" style="flex:1; overflow-y:auto; padding-bottom:20px;"></div>
 </div>

 
<div class="mobile-bottom-nav">
    <a href="/" class="m-nav-item active" onclick="event.preventDefault(); refreshHomeFeed();">
        <i class="fas fa-home"></i>
        <span data-key="home">მთავარი</span>
    </a>
    <a onclick="openDiscovery()" class="m-nav-item">
        <i class="fas fa-users"></i>
        <span data-key="people">ხალხი</span>
    </a>
    <div class="m-nav-item" onclick="document.getElementById('uploadModal').style.display='flex'">
        <div class="token-plus-btn"><i class="fas fa-plus" style="color: #000; font-size: 20px;"></i></div>
        <span style="color: var(--gold); font-weight: bold; margin-top: 5px;">TOKEN</span>
    </div>
    
    <a onclick="openMessenger()" class="m-nav-item" style="position: relative;">
        <i class="fas fa-envelope"></i>
        <span id="chatCountBadge" style="position: absolute; top: 0; right: 15%; background: red; color: white; border-radius: 50%; width: 16px; height: 16px; font-size: 10px; display: none; align-items: center; justify-content: center; border: 1px solid #000; font-weight: bold; z-index: 99;">0</span>
        <span data-key="chat">ჩატი</span>
    </a>

    <div class="m-nav-item" onclick="openProfile(auth.currentUser.uid)">
        <img id="bottomNavAva" src="https://ui-avatars.com/api/?name=U" class="m-nav-ava">
        <span data-key="profile">პროფილი</span>
        <input type="file" id="avaInp" hidden accept="image/*" onchange="uploadNewAva(this)">
    </div>
</div>



<div id="liveUI" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:#000; z-index:99999; flex-direction:column;">
    <div id="live-video-container" style="width:100%; height:100%; background:#111; position:relative;">
        <div id="remote-live-video" style="width:100%; height:100%;"></div>
        
        <div style="position:absolute; top:20px; left:15px; display:flex; align-items:center; gap:10px; background:rgba(0,0,0,0.5); padding:5px 12px; border-radius:30px; border:1px solid rgba(212,175,55,0.3);">
            <img id="liveHostAva" src="" style="width:32px; height:32px; border-radius:50%; border:1px solid var(--gold);">
            <div>
                <b id="liveHostName" style="color:white; font-size:12px; display:block;">Host Name</b>
                <small id="liveViewerCount" style="color:var(--gold); font-size:10px;"><i class="fas fa-eye"></i> 0</small>
            </div>
            <button id="followHostBtn" style="background:var(--gold); border:none; border-radius:15px; padding:4px 10px; font-size:11px; font-weight:bold; margin-left:5px;">Follow</button>
        </div>

        <div style="position:absolute; right:15px; bottom:150px; display:flex; flex-direction:column; gap:20px; align-items:center;">
            <div class="live-action" onclick="sendLiveHeart()"><i class="fas fa-heart" style="color:#ff4d4d; font-size:28px;"></i></div>
            
            <div class="live-action" onclick="toggleGiftPanel()"><i class="fas fa-gift" style="color:var(--gold); font-size:28px;"></i></div>
            
            <div class="live-action" onclick="shareLive()"><i class="fas fa-share" style="color:white; font-size:28px;"></i></div>
            <div class="live-action" onclick="endLive()"><i class="fas fa-times-circle" style="color:#aaa; font-size:28px;"></i></div>
        </div>

        <div id="giftPanel" style="display:none; position:absolute; bottom:0; left:0; width:100%; background:rgba(0,0,0,0.95); border-top:2px solid var(--gold); padding:20px; border-radius:20px 20px 0 0; z-index:100000; box-shadow: 0 -10px 30px rgba(0,0,0,0.5);">
            <div style="display:flex; justify-content:space-between; margin-bottom:20px; align-items:center;">
                <b style="color:var(--gold); font-size:16px; letter-spacing:1px;">გაუგზავნე საჩუქარი</b>
                <i class="fas fa-times" onclick="toggleGiftPanel()" style="color:gray; cursor:pointer; font-size:20px;"></i>
            </div>
            <div style="display:grid; grid-template-columns: repeat(4, 1fr); gap:15px; text-align:center;">
                <div class="gift-item" onclick="sendGift('🌹', 1, 'Rose')" style="cursor:pointer; background:rgba(255,255,255,0.05); padding:10px; border-radius:12px;">
                    <div style="font-size:32px; margin-bottom:5px;">🌹</div>
                    <small style="color:var(--gold); font-weight:bold; display:block;">1</small>
                </div>
                <div class="gift-item" onclick="sendGift('💎', 10, 'Diamond')" style="cursor:pointer; background:rgba(255,255,255,0.05); padding:10px; border-radius:12px;">
                    <div style="font-size:32px; margin-bottom:5px;">💎</div>
                    <small style="color:var(--gold); font-weight:bold; display:block;">10</small>
                </div>
                <div class="gift-item" onclick="sendGift('🦁', 50, 'Lion')" style="cursor:pointer; background:rgba(255,255,255,0.05); padding:10px; border-radius:12px;">
                    <div style="font-size:32px; margin-bottom:5px;">🦁</div>
                    <small style="color:var(--gold); font-weight:bold; display:block;">50</small>
                </div>
                <div class="gift-item" onclick="sendGift('👑', 100, 'Crown')" style="cursor:pointer; background:rgba(255,255,255,0.05); padding:10px; border-radius:12px;">
                    <div style="font-size:32px; margin-bottom:5px;">👑</div>
                    <small style="color:var(--gold); font-weight:bold; display:block;">100</small>
                </div>
            </div>
        </div>

        <div id="liveChatBox" style="position:absolute; bottom:80px; left:15px; width:70%; max-height:200px; overflow-y:auto; display:flex; flex-direction:column; gap:5px; pointer-events:auto;"></div>
        
        <div style="position:absolute; bottom:20px; left:0; width:100%; padding:0 15px; display:flex; gap:10px;">
            <input type="text" id="liveMsgInp" style="flex:1; background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); border-radius:20px; padding:10px 15px; color:white; outline:none;" placeholder="თქვი რამე...">
            <button onclick="sendLiveComment()" style="background:var(--gold); border:none; width:40px; height:40px; border-radius:50%; color:black;"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>
</div>

 
 
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>

<script src="https://download.agora.io/sdk/release/AgoraRTC_N-4.11.0.js"></script>

<script src="videocall.js"></script>
<script src="script.js"></script>
<script src="shopping.js"></script>
<script src="liderbord.js"></script>
<script src="play.js"></script>
<script src="chatvirtva.js"></script>
<script src="fotogaleria.js"></script>

<script>
  const firebaseConfig = { 
    apiKey: "AIzaSyDA1MD_juyLU26Nytxn7kzEcBkpVhS3rbk", 
    authDomain: "emigrantbook.firebaseapp.com", 
    databaseURL: "https://emigrantbook-default-rtdb.europe-west1.firebasedatabase.app", 
    projectId: "emigrantbook", 
    storageBucket: "emigrantbook.firebasestorage.app", 
    appId: "1:138873748174:web:2d4422cdd62cd7e594ee9f" 
  };
  
  // ინიციალიზაცია
  if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
  }



  // ... ინიციალიზაციის მერე ...
  console.log("Firebase ჩაიტვირთა:", firebase.SDK_VERSION);
  if (firebase.storage) {
      console.log("Storage ნაპოვნია! ✅");
  } else {
      console.log("Storage დაკარგულია! ❌");
      alert("კრიტიკული შეცდომა: Storage ბიბლიოთეკა არ ჩაიტვირთა!");
  }


 
  
  // გლობალური ცვლადები
  const db = firebase.database();
  const auth = firebase.auth();
  const storage = firebase.storage(); // აი, აქ ვააქტიურებთ Storage-ს საბოლოოდ
</script>


 
<div id="communityWallUI" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(15px); z-index: 15000; display: none; flex-direction: column;">
 <div style="padding: 15px; border-bottom: 1px solid rgba(212, 175, 55, 0.2); display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.5);">
 <h2 style="color: var(--gold); font-weight: 900; font-size: 18px;">COMMUNITY</h2>
 <i class="fas fa-times" style="font-size: 24px; color: gray; cursor: pointer;" onclick="closeCommunityWall()"></i>
 </div>
 <div style="background: rgba(20,20,20,0.4); padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.05);">
 <div style="display: flex; gap: 10px; margin-bottom: 15px;">
 <img id="wallMyAva" src="" style="width: 45px; height: 45px; border-radius: 50%; border: 1px solid var(--gold); object-fit: cover;">
 <textarea id="wallPostText" style="flex: 1; background: transparent; border: none; color: white; resize: none; outline: none; font-size: 16px; padding-top: 5px;" placeholder="რას ფიქრობ?"></textarea>
 </div>
 <div id="wallImgPreviewBox" style="display: none; width: 100%; position: relative; margin-bottom: 15px;">
 <img id="wallImgPreview" style="width: 100%; border-radius: 10px; border: 1px solid var(--gold); max-height: 200px; object-fit: cover;">
 <i class="fas fa-times-circle" style="position: absolute; top: 5px; right: 5px; color: white; font-size: 20px; cursor: pointer;" onclick="cancelWallImg()"></i>
 </div>
 <div style="display: flex; justify-content: space-between; align-items: center;">
 <div onclick="document.getElementById('wallImgInput').click()" style="color: var(--gold); cursor: pointer; font-size: 14px; font-weight: bold; background: rgba(212,175,55,0.1); padding: 8px 15px; border-radius: 20px;">
 <i class="fas fa-image"></i> ფოტო
 </div>
 <input type="file" id="wallImgInput" accept="image/*" hidden onchange="previewWallImage(this)">
 <button onclick="submitWallPost()" style="background: var(--gold); border: none; padding: 8px 25px; border-radius: 20px; font-weight: bold; cursor: pointer; color: black;">გამოქვეყნება</button>
 </div>
 </div>
 <div id="communityPostsList" style="flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 20px; background: transparent;">
 </div>
</div>
 
 
<div id="videoCallUI" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:#000; z-index:999999; flex-direction:column; align-items:center; justify-content:center; font-family:sans-serif;">
    
    <div id="remote-video" style="width:100%; height:100%; background:#111; position:relative;">
        <div id="remote-label" style="position:absolute; top:20px; left:20px; color:white; background:rgba(0,0,0,0.5); padding:5px 10px; border-radius:5px; font-size:12px;">Waiting for partner...</div>
    </div>

    <div id="local-video" style="width:120px; height:180px; background:#222; position:absolute; bottom:100px; right:20px; border-radius:15px; border:2px solid var(--gold); overflow:hidden; z-index:10; box-shadow: 0 10px 20px rgba(0,0,0,0.5);"></div>

    <div class="call-controls" style="position:absolute; bottom:30px; display:flex; gap:20px; z-index:20;">
        <div onclick="toggleMic()" id="micBtn" style="width:50px; height:50px; background:#333; border-radius:50%; display:flex; align-items:center; justify-content:center; color:white; cursor:pointer;">
            <i class="fas fa-microphone"></i>
        </div>
        <div onclick="endVideoCall()" style="width:65px; height:65px; background:#ff4d4d; border-radius:50%; display:flex; align-items:center; justify-content:center; color:white; cursor:pointer; font-size:24px; box-shadow:0 0 15px rgba(255,77,77,0.5);">
            <i class="fas fa-phone-slash"></i>
        </div>
        <div onclick="toggleCam()" id="camBtn" style="width:50px; height:50px; background:#333; border-radius:50%; display:flex; align-items:center; justify-content:center; color:white; cursor:pointer;">
            <i class="fas fa-video"></i>
        </div>
    </div>

    <div onclick="minimizeVideoCall()" style="position:absolute; top:20px; right:20px; color:white; cursor:pointer; background:rgba(255,255,255,0.1); padding:10px; border-radius:50%;">
        <i class="fas fa-expand-alt"></i>
    </div>
</div>
























<div id="shopSectionContainer" style="display:none; position:fixed; top:0; left:0; width:100%; height:100vh; background:#000; z-index:999999; flex-direction:column; overflow:hidden;">
    
    <div style="padding:15px; background:#000; border-bottom:1px solid #222; display:flex; flex-direction:column; gap:15px;">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h2 style="color:var(--gold); margin:0; font-size:18px; letter-spacing:1px;">IMPACT STORE</h2>
            <div id="cartTrigger" onclick="openCartView()" style="position:relative; cursor:pointer; background:rgba(212,175,55,0.1); padding:8px 15px; border-radius:12px; border:1px solid #333;">
                🛒 <span id="cartCountBadge" style="color:var(--gold); font-weight:bold;">0</span>
            </div>
        </div>
        
        <div style="display:flex; gap:8px; overflow-x:auto; padding-bottom:5px;">
            <button class="shop-tab active" onclick="renderStore('all', this)">ყველა</button>
            <button class="shop-tab" onclick="renderStore('digital', this)">ციფრული</button>
            <button class="shop-tab" onclick="renderStore('physical', this)">ნივთები</button>
            <button class="shop-tab" onclick="renderStore('vip', this)">VIP</button>
        </div>
    </div>

    <div id="adminStorePanel" style="display:none; background:rgba(212,175,55,0.05); padding:15px; border-bottom:1px solid var(--gold);">
        <b style="color:var(--gold); display:block; margin-bottom:10px; font-size:12px;">🛠 ადმინ მართვა</b>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px;">
            <input type="text" id="newProdName" class="auth-input" placeholder="სახელი">
            <input type="number" id="newProdPrice" class="auth-input" placeholder="ფასი (₾)">
        </div>
        <div style="display:flex; gap:8px; margin-top:8px;">
            <input type="file" id="newProdFile" accept="image/*" style="flex:1; color:white; font-size:12px;">
            <select id="newProdCat" class="auth-input" style="width:100px; margin:0;">
                <option value="digital">ციფრული</option>
                <option value="physical">ნივთები</option>
                <option value="vip">VIP</option>
            </select>
        </div>
     <input type="text" id="newProdStripeLink" class="auth-input" placeholder="Stripe-ის ლინკი">
     <textarea id="newProdDesc" class="auth-input" placeholder="აღწერა"></textarea>
        <button onclick="saveProductToFirebase()" style="width:100%; background:var(--gold); color:black; border:none; padding:10px; border-radius:8px; margin-top:10px; font-weight:bold;">დამატება 🚀</button>
    </div>

    <div style="flex:1; overflow-y:auto; padding:15px;">
        <div id="productsGrid" style="display:grid; grid-template-columns:1fr 1fr; gap:15px;"></div>
        <div onclick="document.getElementById('shopSectionContainer').style.display='none';" style="color:gray; text-align:center; padding:30px; cursor:pointer; font-size:12px;">← დახურვა</div>
    </div>

    <div id="productDetailsModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:1000000; flex-direction:column; overflow-y:auto; padding:20px; box-sizing:border-box;">
        <div style="width:100%; display:flex; justify-content:flex-end;">
            <span onclick="closeProductDetails()" style="font-size:30px; color:gray; cursor:pointer; padding:10px;">✕</span>
        </div>
        <div id="detailsContent" style="display:flex; flex-direction:column; align-items:center; gap:20px; margin-top:10px;"></div>
    </div>

    <div id="orderFormModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.98); z-index:2000000; flex-direction:column; overflow-y:auto; padding:20px; box-sizing:border-box;">
        <div style="width:100%; display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:1px solid #222; padding-bottom:10px;">
            <h2 style="color:var(--gold); font-size:18px; margin:0;">შეკვეთის გაფორმება</h2>
            <span onclick="document.getElementById('orderFormModal').style.display='none'" style="font-size:25px; color:gray; cursor:pointer;">✕</span>
        </div>

        <div style="display:flex; flex-direction:column; gap:12px;">
            <input type="text" id="ordFirstName" class="auth-input" placeholder="სახელი">
            <input type="text" id="ordLastName" class="auth-input" placeholder="გვარი">
            <input type="text" id="ordCountry" class="auth-input" placeholder="ქვეყანა">
            <input type="text" id="ordCity" class="auth-input" placeholder="ქალაქი">
            <input type="text" id="ordAddress" class="auth-input" placeholder="ზუსტი მისამართი">
            <input type="tel" id="ordPhone" class="auth-input" placeholder="ტელეფონის ნომერი">
            <input type="email" id="ordEmail" class="auth-input" placeholder="ელ-ფოსტა">
            
            <div style="background:#111; padding:15px; border-radius:12px; border:1px solid #333; margin-top:10px;">
                <p style="color:gray; margin:0 0 5px 0; font-size:12px;">გადასახდელი ჯამი:</p>
                <b id="finalPriceDisplay" style="color:#00ff00; font-size:20px;">0 ₾</b>
            </div>

            <button onclick="processOrderAndPay()" style="width:100%; background:#d4af37; color:black; padding:18px; border:none; border-radius:15px; font-weight:900; font-size:16px; margin-top:10px; cursor:pointer; box-shadow: 0 5px 15px rgba(212, 175, 55, 0.2);">
                მონაცემების შენახვა და გადახდა 🚀
            </button>
        </div>
    </div>
</div>







 
 <div id="leaderboardUI" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:100000; flex-direction:column; padding:20px; box-sizing:border-box;">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:1px solid var(--gold); padding-bottom:10px;">
        <h2 style="color:var(--gold); margin:0; letter-spacing:1px;"><i class="fas fa-trophy"></i> TOP IMPACTORS</h2>
        <span onclick="document.getElementById('leaderboardUI').style.display='none'" style="font-size:30px; color:gray; cursor:pointer;">✕</span>
    </div>

    <div id="leaderboardList" style="flex:1; overflow-y:auto; display:flex; flex-direction:column; gap:10px;">
        </div>

    <div style="text-align:center; padding-top:20px; color:gray; font-size:12px;">
        რეიტინგი ახლდება რეალურ დროში 🚀
    </div>
</div>












 <div id="liveNotification" style="display:none; position:fixed; bottom:20px; left:20px; background:#1a1a1a; border:1px solid var(--gold); border-radius:12px; padding:15px; z-index:200000; width:280px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); animation: slideIn 0.5s ease-out;">
    <div style="display:flex; align-items:center; gap:12px;">
        <div id="notifIcon" style="font-size:24px;">🚀</div>
        <div style="flex:1;">
            <b id="notifTitle" style="color:var(--gold); display:block; font-size:13px;">შეტყობინება</b>
            <span id="notifText" style="color:white; font-size:12px;">ვიღაცამ რაღაც ქნა...</span>
        </div>
        <i class="fas fa-times" onclick="hideNotification()" style="color:gray; cursor:pointer; font-size:14px;"></i>
    </div>
</div>

<style>
@keyframes slideIn {
    from { transform: translateX(-100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}
</style>









<div id="gallery_photoPreviewModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:200000;">
    <div style="position: relative; width: 95%; max-width: 450px; aspect-ratio: 9 / 16; background: #000; border-radius: 15px; overflow: hidden; display: flex; justify-content: center; align-items: center; border: 1px solid rgba(212,175,55,0.3);">
        
        <img id="gallery_fullPhotoImg" src="" style="width: 100%; height: 100%; object-fit: cover;">
        
        <div style="position: absolute; right: 15px; bottom: 120px; display: flex; flex-direction: column; gap: 20px; align-items: center; z-index: 10;">
            
            <div onclick="gallery_handleLike(event)" style="text-align: center; cursor: pointer;">
                <div style="width: 45px; height: 45px; background: rgba(0,0,0,0.5); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 5px;">
                    <i id="gallery_photoLikeIcon" class="fas fa-heart" style="color: white; font-size: 22px; transition: 0.3s;"></i>
                </div>
                <span id="gallery_photoLikeCount" style="color: white; font-size: 12px; font-weight: bold;">0</span>
            </div>

            <div onclick="gallery_openComments(event)" style="text-align: center; cursor: pointer;">
                <div style="width: 45px; height: 45px; background: rgba(0,0,0,0.5); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 5px;">
                    <i class="fas fa-comment-dots" style="color: white; font-size: 22px;"></i>
                </div>
                <span id="gallery_photoCommCount" style="color: white; font-size: 12px; font-weight: bold;">0</span>
            </div>

            <div style="text-align: center;">
                <div style="width: 45px; height: 45px; background: rgba(0,0,0,0.5); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 5px;">
                    <i class="fas fa-eye" style="color: white; font-size: 20px;"></i>
                </div>
                <span id="gallery_photoViewCount" style="color: white; font-size: 12px; font-weight: bold;">0</span>
            </div>
        </div>

        <div style="position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); width: 90%; display: flex; gap: 10px; align-items: center; z-index: 20;">
            <input type="text" id="gallery_photoCommInput" placeholder="დაწერე კომენტარი..." 
                   style="flex: 1; background: rgba(255,255,255,0.1); border: 1px solid rgba(212,175,55,0.3); border-radius: 20px; padding: 10px 15px; color: white; outline: none; font-size: 14px;">
            
            <button onclick="gallery_submitComment()" 
                    style="background: #d4af37; border: none; width: 40px; height: 40px; border-radius: 50%; color: black; display: flex; align-items: center; justify-content: center; cursor: pointer;">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>

        <span onclick="document.getElementById('gallery_photoPreviewModal').style.display='none'" style="position:absolute; top:20px; left:20px; color:white; font-size:22px; cursor:pointer; background:rgba(0,0,0,0.5); width:35px; height:35px; display:flex; align-items:center; justify-content:center; border-radius:50%; z-index:11;">✕</span>
    </div>
</div>


 





 <div id="splash-screen">
    <div class="splash-content">
        <img src="https://emigrantbook.com/1000084015-removebg-preview.png" alt="Logo" class="splash-logo">
        <div class="splash-loader"></div>
    </div>
</div>






 

 <div id="incomingCallModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); backdrop-filter:blur(10px); z-index:1000000; align-items:center; justify-content:center; flex-direction:column; font-family:sans-serif;">
    <div style="background:#1a1a1a; width:280px; padding:40px 20px; border-radius:30px; border:1px solid var(--gold); text-align:center; box-shadow:0 0 30px rgba(212,175,55,0.3);">
        <img id="callerAva" src="" style="width:100px; height:100px; border-radius:50%; border:3px solid var(--gold); margin-bottom:20px; object-fit:cover;">
        <h2 id="callerNameDisplay" style="color:white; margin:0 0 10px 0; font-size:20px;">Levani...</h2>
        <p style="color:var(--gold); font-size:14px; margin-bottom:30px; letter-spacing:1px; animation: pulse-text 1.5s infinite;">ვიდეო ზარი შემოდის...</p>
        
        <div style="display:flex; justify-content:space-around; width:100%;">
            <div onclick="declineCall()" style="width:60px; height:60px; background:#ff4d4d; border-radius:50%; display:flex; align-items:center; justify-content:center; color:white; cursor:pointer; font-size:24px;">
                <i class="fas fa-phone-slash"></i>
            </div>
            <div onclick="acceptCall()" style="width:60px; height:60px; background:#4ade80; border-radius:50%; display:flex; align-items:center; justify-content:center; color:white; cursor:pointer; font-size:24px; box-shadow:0 0 15px rgba(74,222,128,0.5);">
                <i class="fas fa-video"></i>
            </div>
        </div>
    </div>
</div>

<style>
@keyframes pulse-text {
    0% { opacity: 1; }
    50% { opacity: 0.5; }
    100% { opacity: 1; }
}
</style>
</body>
</html>
